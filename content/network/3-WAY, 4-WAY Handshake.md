# TCP 3-Way Handshake & 4-Way Handshake

## TCP(Transmission Control Protocol) λ€?

> μΈν„°λ„·μ—μ„ μ‹ λΆ°μ„± μλ” λ°μ΄ν„° μ „μ†΅μ„ λ‹΄λ‹Ήν•λ” ν•µμ‹¬ ν”„λ΅ν† μ½

- **μ£Όμ” νΉμ§•**: λ°μ΄ν„°λ¥Ό **μ •ν™•ν•κ²**, **μμ„λ€λ΅**, **λΉ μ§μ—†μ΄ μ „μ†΅**
- **μ‹¤μƒν™ μμ‹**: μ›Ήμ‚¬μ΄νΈ μ ‘μ†, νμΌ λ‹¤μ΄λ΅λ“, μ΄λ©”μΌ λ“±  
  λ°λ“μ‹ μμ‹ μκ°€ μ •λ³΄λ¥Ό λ°›μ•„μ•Ό ν•λ” **μ‹ λΆ°μ„± μλ” ν†µμ‹ **μ΄ ν•„μ”ν•  λ• μ‚¬μ©λ¨

TCPλ” μ΄λ¬ν• μ‹ λΆ°μ„±μ„ λ³΄μ¥ν•κΈ° μ„ν•΄ **ν†µμ‹  μ‹μ‘ μ‹**μ™€ **μΆ…λ£ μ‹** νΉλ³„ν• μ μ°¨λ¥Ό κ±°μΉ¨
μ΄λ• μ‚¬μ©λλ” κ³Όμ •μ΄ λ°”λ΅ **3-Way Handshake (μ—°κ²° μ„±λ¦½)**, **4-Way Handshake (μ—°κ²° ν•΄μ )** 

---

## π”— 3-Way Handshake: μ—°κ²° μ„±λ¦½

<img width="500" height="400" alt="image" src="https://github.com/user-attachments/assets/5ba2cf70-48ed-4d6d-813a-dcf91c279374" />


1. **Client β†’ Server : SYN μ „μ†΅ (μ—°κ²° μ”μ²­)**  
   ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ— μ—°κ²° μ”μ²­μ„ ν•λ©΄μ„ **SYN ν”λκ·Έ**κ°€ μ„¤μ •λ ν¨ν‚·μ„ λ³΄λƒ„

2. **Server β†’ Client : SYN + ACK μ „μ†΅ (μ”μ²­ μλ½ λ° λ™κΈ°ν™” μ‹ νΈ)**  
   μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈμ SYNμ„ λ°›κ³ , μ‘λ‹µμΌλ΅ SYNκ³Ό ACKλ¥Ό ν•©μΉ ν¨ν‚·μ„ μ „μ†΅

3. **Client β†’ Server : ACK μ „μ†΅ (ν™•μΈ μ‘λ‹µ)**  
   ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ μ‘λ‹µμ„ λ°›κ³  **μµμΆ… ACK**λ¥Ό μ „μ†΅ν•λ©΄ μ—°κ²°μ΄ μ„±λ¦½λ¨

β… μ΄λ ‡κ² **3λ²μ ν†µμ‹ **μ΄ μ™„λ£λλ©΄ **TCP μ—°κ²°μ΄ μ„±λ¦½**λλ‹¤.

---

## π” 4-Way Handshake: μ—°κ²° ν•΄μ 

(<img width="400" height="400" alt="image" src="https://github.com/user-attachments/assets/d12147a2-f794-4028-b413-6330600197b9" />)

### 1. Client β†’ Server : FIN μ „μ†΅  
ν΄λΌμ΄μ–ΈνΈκ°€ μ—°κ²° μΆ…λ£λ¥Ό μ”μ²­ν•λ©° FIN ν”λκ·Έλ¥Ό λ³΄λƒ„  
β†’ ν΄λΌμ΄μ–ΈνΈλ” **FIN-WAIT-1** μƒνƒλ΅ μ§„μ…

#### π”Έ FIN-WAIT μƒνƒλ€?
> TCPμ—μ„ μ—°κ²°μ„ μΆ…λ£ν•κ³ μ ν•λ” μ½μ΄  
> λ¨Όμ € FIN ν¨ν‚·μ„ μ „μ†΅ν• ν›„ κΈ°λ‹¤λ¦¬λ” μƒνƒ

---

### 2. Server β†’ Client : ACK μ „μ†΅  
μ„λ²„λ” FINμ„ λ°›κ³  ACKλ¥Ό μ „μ†΅  
β†’ μ„λ²„λ” **CLOSE-WAIT** μƒνƒλ΅ μ§„μ…

#### π”Έ CLOSE-WAIT μƒνƒλ€?
- μƒλ€λ°©μ΄ λ¨Όμ € FIN ν¨ν‚·μ„ λ³΄λƒκ³ 
- λ‚΄κ°€ κ·Έ FINμ— λ€ν•΄ ACKλ¥Ό μ‘λ‹µν• μƒνƒ
- **μ•„μ§ λ‚΄ μ½μ—μ„ FINμ„ λ³΄λ‚΄μ§€ μ•μ€ μƒνƒ**

---

### 3. Server β†’ Client : FIN μ „μ†΅  
μ„λ²„κ°€ μ—°κ²°μ„ μΆ…λ£ν•  μ¤€λΉ„κ°€ λλ©΄ FIN ν”λκ·Έλ¥Ό ν΄λΌμ΄μ–ΈνΈμ— μ „μ†΅  
β†’ μ„λ²„λ” **LAST-ACK** μƒνƒλ΅ μ§„μ…

#### π”Έ LAST-ACK μƒνƒλ€?
- λ‚΄κ°€ λ¨Όμ € FINμ„ λ°›μ€ ν›„,
- κ·Έμ— λ€ν• ACKμ„ λ³΄λ‚Έ λ’¤,
- **λ‚λ„ FINμ„ λ³΄λ‚΄κ³ **,
- μƒλ€λ°©μ μµμΆ… ACKλ¥Ό κΈ°λ‹¤λ¦¬λ” μƒνƒ

---

### 4. Client β†’ Server : ACK μ „μ†΅  
ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„μ FINμ„ λ°›κ³  **λ§μ§€λ§‰ ACK**λ¥Ό μ „μ†΅  
β†’ ν΄λΌμ΄μ–ΈνΈλ” **TIME-WAIT** μƒνƒλ΅ μ§„μ…ν•κ³  μΌμ • μ‹κ°„ ν›„ **CLOSED**

#### π”Έ TIME-WAIT μƒνƒλ€?

<img width="400" height="400" alt="image" src="https://github.com/user-attachments/assets/b32f1328-90db-4057-9eef-5abd9bcf9906" />



- TCP 4-Way Handshakeμ—μ„ **μ—°κ²°μ„ λ¨Όμ € λμ€ μ½μ—μ„ λ°μƒ**
- λ§μ§€λ§‰ ACK ν¨ν‚·μ μ μ‹¤μ΄λ‚ ν¨ν‚· μ§€μ—°μ— λ€λΉ„ν•μ—¬ **μΌμ • μ‹κ°„ λ™μ• μ†μΌ“μ„ μ μ§€**

> μ: λ§μ§€λ§‰ ACKκ°€ μ μ‹¤λλ©΄ μ„λ²„λ” λ‹¤μ‹ FINμ„ λ³΄λ‚Ό μ μμ.  
> μ΄λ• ν΄λΌμ΄μ–ΈνΈλ” TIME-WAIT μƒνƒ λ•λ¶„μ— FINμ„ λ‹¤μ‹ λ°›μ•„ ACKλ¥Ό μ¬μ „μ†΅ν•  μ μμ.


β… μ΄λ ‡κ² 4λ²μ ν†µμ‹ μ΄ μ™„λ£λλ©΄ **TCP μ—°κ²°μ΄ μ•μ „ν•κ² ν•΄μ **λλ‹¤.

---

## π“ μ°Έκ³  μλ£

- [gyoogle/tech-interview-for-developer - GitHub](https://github.com/gyoogle/tech-interview-for-developer/blob/master/Computer%20Science/Network/TCP%203%20way%20handshake%20%26%204%20way%20handshake.md)
- [λ„¤νΈμ›ν¬ μ†μΌ“ μƒνƒ μ •λ¦¬ - Medium](https://medium.com/@hyukjuner/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%86%8C%EC%BC%93-%EC%83%81%ED%83%9C-time-wait-close-wait-21813a5c625)

---

