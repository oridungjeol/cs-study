# 웹 인증 방식(쿠키, 세션, 토큰)

## 쿠키 (Cookie)

- **정의**  
  웹 브라우저에 저장되는 작은 데이터 조각.  
  사용자의 상태 정보를 서버가 기억할 수 있게 해주는 수단.

- **왜 필요할까?**  
  웹은 기본적으로 상태를 기억하지 못하는(stateless) 구조.  
  예: 사용자가 로그인해도, 다음 요청 때 서버는 누군지 알 수 없음.  
  → 이때 쿠키를 이용해 사용자 정보를 브라우저에 저장하면, 다음 요청에도 서버가 “아, 이 사용자구나!”하고 기억 가능.

- **쿠키에 담기는 정보**  
  - 로그인 세션 ID  
  - 장바구니 정보  
  - 사용자 선호 언어 (언어 설정)  
  - 사이트 방문 기록 등

- **쿠키 작동 방식**
  1. 사용자가 사이트에 로그인함
  2. 서버가 사용자에게 `Set-Cookie` 응답 헤더를 통해 쿠키를 전달함  
     > **Set-Cookie** : 서버가 브라우저에게 쿠키를 저장하라고 명령하는 방식
  3. 브라우저는 쿠키를 저장
  4. 이후 같은 사이트에 요청할 때마다 브라우저가 `Cookie` 헤더에 자동으로 쿠키를 실어 보냄
 
---

## 세션 (Session)

- **정의**  
  서버가 사용자별 상태를 기억하는 방법.  
  사용자가 로그인하면 서버가 고유한 세션 ID를 발급.

- **특징**  
  - 세션 ID는 보통 `JSESSIONID`라는 이름의 쿠키로 클라이언트(브라우저)에 저장됨  
  - 이후 요청마다 서버로 전송되어 누가 요청했는지 서버가 알 수 있음  
  - 서버가 사용자 정보를 메모리나 DB에 저장 (상태 저장, Stateful)  
  - 세션 만료 시간이 있음  
  - 보안 설정 가능

- **세션 작동 방식**  
  1. 사용자가 로그인하면 서버가 새로운 세션 생성 → 세션 ID 발급  
  2. 서버는 세션 ID (`JSESSIONID`)를 쿠키로 클라이언트에 보냄 (`Set-Cookie`)  
  3. 브라우저는 모든 후속 요청에 세션 쿠키를 자동 포함  
  4. 서버는 세션 ID를 보고 해당 사용자의 정보를 메모리나 DB에서 찾아 인증 처리

---

## 토큰(Token - JWT)

- **정의**  
  서버가 인증 정보를 토큰 안에 직접 담아서 클라이언트에 주는 방식.

- **특징**  
  - 서버는 토큰에 사용자 정보, 권한, 만료 시간 등을 암호화하거나 서명해서 담음  
  - 클라이언트는 이 토큰을 저장했다가 API 요청할 때마다 보내서 인증 증명  
  - 무상태(Stateless) 방식 → 서버에 사용자 상태 저장하지 않음  
  - 토큰 자체가 사용자 인증 정보와 권한 정보를 포함  
  - 토큰 만료 시간을 JWT 내부에 명시 가능  
  - 토큰 위조 방지를 위해 서버가 비밀키로 서명

- **토큰 작동 방식**  
  1. 사용자가 로그인 성공 시 서버가 비밀키로 서명된 JWT 토큰 발급 → 클라이언트로 전달 (서버는 별도 인증 정보 저장 안 함)  
  2. 클라이언트가 토큰을 로컬 스토리지, 세션스토리지, 혹은 쿠키에 저장  
  3. API 요청 시마다 토큰을 `Authorization` 헤더에 담아 보냄  
  4. 서버는 토큰 서명을 검사하고, 유효하면 요청 처리


## 쿠키 VS 세션 VS 토큰

| 특징 | 쿠키 (Cookie) | 세션 (Session) | 토큰 (Token, JWT 등) | 
| -------- | ------------------------------ | ------------------------------- | ------------------------------- | 
| 저장 위치 | 클라이언트(브라우저) | 서버(사용자 상태 저장) + 클라이언트(세션 ID 쿠키) | 클라이언트(로컬스토리지, 쿠키 등) | 
| 상태 관리 | 클라이언트 기반 | 서버 기반 (상태 저장) | 무상태(stateless), 서버에 상태 저장하지 않음 | 
| 인증 정보 저장 | 간단한 정보(세션 ID 등) | 서버가 사용자 인증 정보 직접 관리 | 토큰에 인증 정보 포함, 서명으로 검증 가능 | 

