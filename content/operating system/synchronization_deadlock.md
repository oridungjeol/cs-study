> **운영체제가 할 일**
>
> 1. 프로세스 / 스레드 관리  
> 2. 메모리 관리  
> 3. 파일 시스템 / 저장장치 관리  
> 4. 입출력 장치 관리  
> 5. **동기화 및 교착 상태 관리**

# 동기화와 교착 상태

멀티프로세스/멀티스레드 환경에서는 **공유 자원에 동시에 접근하면서 문제**가 발생할 수 있음.  
운영체제는 이러한 문제를 해결하기 위해 **프로세스 간 동기화**와 **교착 상태 방지** 기능을 수행함.

---

# 개념 정리

## 임계 구역 (Critical Section)

- 여러 프로세스가 동시에 접근하면 안 되는 **공유 자원에 접근하는 코드 영역**
- 동기화는 이 임계 구역에 하나의 프로세스만 접근하게 만드는 것이 목적임

## 동기화 문제 해결 조건 (C. A. R. Hoare)

1. **상호 배제**: 하나의 프로세스만 임계 구역에 들어갈 수 있어야 함  
2. **진행 조건**: 임계 구역에 들어갈 프로세스를 결정할 때 무한정 기다리지 않아야 함  
3. **한정 대기**: 어떤 프로세스도 영원히 기다리지 않아야 함

---

# 동기화 방법

## 하드웨어 기반

- CPU가 제공하는 원자적 명령어 사용 (예: `Test-and-Set`, `Compare-and-Swap`)  
- 커널 내부에서 동기화에 사용되며, **간단하고 빠르지만 확장성 제한**이 있음

## 소프트웨어 기반

- 운영체제 또는 사용자 수준에서 구현된 알고리즘 (예: Peterson 알고리즘 등)  
- 교육용이나 단순한 환경에서 사용되며, 복잡하거나 신뢰성이 낮음

---

# 동기화 도구

## 세마포어 (Semaphore)

- 정수 변수로 자원의 접근을 제어함  
- 두 개의 연산으로 구성됨: `wait(P)`, `signal(V)`
- 여러 자원 관리가 가능한 **카운팅 세마포어**, 0 또는 1만 가지는 **이진 세마포어**로 나뉨

## 뮤텍스 (Mutex)

- 하나의 자원에 대해 **서로 배제적인 접근**을 보장함  
- `lock()` / `unlock()` 메서드로 구성됨  
- 일반적으로 단일 자원 보호에 사용됨

## 모니터 (Monitor)

- 고급 언어 수준에서 제공되는 **동기화 추상화 구조**임  
- 내부적으로 뮤텍스 + 조건 변수 조합으로 구성되어 있음

---

# 교착 상태 (Deadlock)

## 정의

- 여러 프로세스가 자원을 점유한 채 서로 **다른 프로세스의 자원을 기다리는 상태**로, 진행 불가능한 상태임

## 발생 조건 (Coffman 조건)

1. **상호 배제**: 자원은 한 번에 하나의 프로세스만 사용 가능함  
2. **점유와 대기**: 자원을 점유한 채 다른 자원을 요청함  
3. **비선점**: 자원을 강제로 뺏을 수 없음  
4. **순환 대기**: 프로세스들이 서로 자원을 기다리며 원형 구조를 이룸

---

# 교착 상태 해결 방법

## 예방 (Prevention)

- Coffman 조건 중 하나 이상을 사전에 제거함  
- 예: 자원을 요청하기 전에 모두 확보하거나, 자원 순서를 고정함

## 회피 (Avoidance)

- 시스템 상태가 **안전한지 확인** 후 자원 할당을 결정함  
- 대표적으로 **은행가 알고리즘(Banker's Algorithm)** 사용

## 탐지 및 회복 (Detection & Recovery)

- 교착 상태 발생 후 이를 **탐지**하고, **해결 절차** 수행함  
- 탐지 방법: **자원 할당 그래프(Resource Allocation Graph)**  
- 회복 방법: 프로세스 종료, 자원 회수 등

---

# 동기화 도구 비교

| 항목 | 세마포어 | 뮤텍스 | 모니터 |
|------|----------|--------|--------|
| 접근 제어 | 여러 자원 | 하나의 자원 | 내부 상태 자동 제어 |
| 구현 위치 | 운영체제 / 사용자 | 운영체제 | 프로그래밍 언어 |
| 구조 | 정수 + 연산 | Lock / Unlock | 객체 기반 |

